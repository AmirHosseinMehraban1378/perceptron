clear;
clc;
%%
%perceptron- AND - binery input - bipolar target
        % training part
Pa1=[-1;-1;1;1;-1;-1;-1;...
    -1;-1;-1;1;-1;-1;-1;...
    -1;-1;-1;1;-1;-1;-1;...
    -1;-1;1;-1;1;-1;-1;...
    -1;-1;1;-1;1;-1;-1;...
    -1;1;1;1;1;1;-1;...
    -1;1;-1;-1;-1;1;-1;...
    -1;1;-1;-1;-1;1;-1;...
    1;1;1;-1;1;1;1;...
    1];
Pa2=[-1;-1;-1;1;-1;-1;-1;...
    -1;-1;-1;1;-1;-1;-1;...
    -1;-1;-1;1;-1;-1;-1;...
    -1;-1;1;-1;1;-1;-1;...
    -1;-1;1;-1;1;-1;-1;...
    -1;1;1;1;1;1;-1;...
    -1;1;-1;-1;-1;1;-1;...
    -1;1;-1;-1;-1;1;-1;...
    -1;1;-1;-1;-1;1;-1;...
    1];
Pa3=[-1;-1;-1;1;-1;-1;-1;...
    -1;-1;-1;1;-1;-1;-1;...
    -1;-1;1;-1;1;-1;-1;...
    -1;-1;1;-1;1;-1;-1;...
    -1;1;-1;-1;-1;1;-1;...
    -1;1;1;1;1;1;-1;...
    1;-1;-1;-1;-1;-1;1;...
    1;-1;-1;-1;-1;-1;1;...
    1;1;-1;-1;-1;1;1;...
    1];
Pb1=[1;1;1;1;1;1;-1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;1;1;1;1;-1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;-1;-1;-1;-1;1;...
     1;1;1;1;1;1;-1;...
     1];
 Pb2=[1;1;1;1;1;1;-1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;1;1;1;1;1;-1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;1;1;1;1;1;-1;...
     1];
 Pb3=[1;1;1;1;1;1;-1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;1;1;1;1;-1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;-1;-1;-1;-1;1;...
    -1;1;-1;-1;-1;-1;1;...
     1;1;1;1;1;1;-1;...
     1];
 Pc1=[-1;-1;1;1;1;1;1;...
     -1;1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;-1;1;1;1;1;-1;...
     1];
  Pc2=[-1;-1;1;1;1;-1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;-1;1;1;1;-1;-1;...
     1];
   Pc3=[-1;-1;1;1;1;-1;1;...
     -1;1;-1;-1;-1;1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;-1;1;1;1;-1;-1;...
     1];
 Pd1=[1;1;1;1;1;-1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;1;-1;...
     1;1;1;1;1;-1;-1;...
     1];
 Pd2=[1;1;1;1;1;-1;-1;...
     1;-1;-1;-1;-1;1;-1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;-1;1;...
     1;-1;-1;-1;-1;1;-1;...
     1;1;1;1;1;-1;-1;...
     1];
  Pd3=[1;1;1;1;1;-1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;1;-1;...
     1;1;1;1;1;-1;-1;...
     1];
 Pe1=[1;1;1;1;1;1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;-1;-1;-1;...
     -1;1;-1;1;-1;-1;-1;...
     -1;1;1;1;-1;-1;-1;...
     -1;1;-1;1;-1;-1;-1;...
     -1;1;-1;-1;-1;-1;-1;...
     -1;1;-1;-1;-1;-1;1;...
     1;1;1;1;1;1;1;...
     1];
  Pe2=[1;1;1;1;1;1;1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;1;1;1;1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;-1;-1;-1;-1;-1;-1;...
     1;1;1;1;1;1;1;...
     1];
  Pe3=[1;1;1;1;1;1;1;...
     -1;1;-1;-1;-1;-1;1;...
     -1;1;-1;-1;1;-1;-1;...
     -1;1;1;1;1;-1;-1;...
     -1;1;-1;-1;1;-1;-1;...
     -1;1;-1;-1;-1;-1;-1;...
     -1;1;-1;-1;-1;-1;-1;...
     -1;1;-1;-1;-1;-1;1;...
     1;1;1;1;1;1;1;...
     1];
  Pj1=[-1;-1;-1;1;1;1;1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;-1;1;1;1;-1;-1;...
     1];
  Pj2=[-1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;-1;1;1;1;-1;-1;...
     1];
  Pj3=[-1;-1;-1;-1;1;1;1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;-1;-1;-1;-1;1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;-1;1;1;1;-1;-1;...
     1];
  Pk1=[1;1;1;-1;-1;1;1;...
     -1;1;-1;-1;1;-1;-1;...
     -1;1;-1;1;-1;-1;-1;...
     -1;1;1;-1;-1;-1;-1;...
     -1;1;1;-1;-1;-1;-1;...
     -1;1;-1;1;-1;-1;-1;...
     -1;1;-1;-1;1;-1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     1;1;1;-1;-1;1;1;...
     1];
  Pk2=[1;-1;-1;-1;-1;1;-1;...
     1;-1;-1;-1;1;-1;-1;...
     1;-1;-1;1;-1;-1;-1;...
     1;-1;1;-1;-1;-1;-1;...
     1;1;-1;-1;-1;-1;-1;...
     1;-1;1;-1;-1;-1;-1;...
     1;-1;-1;1;-1;-1;-1;...
     1;-1;-1;-1;1;-1;-1;...
     1;-1;-1;-1;-1;1;-1;...
     1];
  Pk3=[1;1;1;-1;-1;1;1;...
     -1;1;-1;-1;-1;1;-1;...
     -1;1;-1;-1;1;-1;-1;...
     -1;1;-1;1;-1;-1;-1;...
     -1;1;1;-1;-1;-1;-1;...
     -1;1;-1;1;-1;-1;-1;...
     -1;1;-1;-1;1;-1;-1;...
     -1;1;-1;-1;-1;1;-1;...
     1;1;1;-1;-1;1;1;...
     1];
 p=[Pa1 Pb1 Pc1 Pd1 Pe1 Pj1 Pk1 Pa2 Pb2  Pc2 Pd2 Pe2 Pj2 Pk2 ...
    Pa3 Pb3 Pc3 Pd3 Pe3 Pj3 Pk3];
        % target part
t=[1 -1 -1 -1 -1 -1 -1;...
    -1 1 -1 -1 -1 -1 -1;...
    -1 -1 1 -1 -1 -1 -1;...
    -1 -1 -1 1 -1 -1 -1;...
    -1 -1 -1 -1 1 -1 -1;...
    -1 -1 -1 -1 -1 1 -1;...
    -1 -1 -1 -1 -1 -1 1];
        % neural network code part
[R, C]=size(p);
m=length(t);
alpha=1;
Wold=zeros(R,m);
k=0;
Wnew=[];
Y=[];
loop=0;
q=1;
while k < C        %loop based on the numbers of training columes
    loop = loop +1;      %counter of loops
for i=1:C
  y_in= (Wold')*p(:,i);
  for j=1:m            %finding vector Y
      if y_in(j) > 0
          Y(j)=1;
      else
          Y(j)=-1;
      end
  end
 if q > m   %condition for repeating the target matrix
   q=1;
 end
for v=1:m
 if Y(v) == t(v,q)
   Wnew(:,v)=Wold(:,v);
 else
   for u=1:R
     Wnew(u,v)=Wold(u,v) + (alpha)*(p(u,i))*(t(v,q));
   end
 end
end
  q=q+1;
  Wold=Wnew;       
end
     if Wnew - Wold == zeros(R,m)
        k=k+1;
     else
        k=0;
     end 
end
Wbest=Wnew
loop
%%
        % testing the code by giving incorrect matrix
Xtest = input('input Xtest: ');
Y_inTest = (Wbest')*(Xtest);

  for j=1:m            %finding Ytest by Y-inTest
      if Y_inTest(j) > 0
          Ytest(j,1)=1;
      else
          Ytest(j,1)=-1;
      end
  end
 
  if Ytest == t(:,1)
      fprintf('the character is A')
  elseif  Ytest == t(:,2)
      fprintf('the character is B')
  elseif  Ytest == t(:,3)
      fprintf('the character is C')
  elseif  Ytest == t(:,4)
      fprintf('the character is D')
  elseif  Ytest == t(:,5)
      fprintf('the character is E')
  elseif  Ytest == t(:,6)
      fprintf('the character is J')
  elseif  Ytest == t(:,7)
      fprintf('the character is K')
  end